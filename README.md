# Maintenance Packages

## Description

This project hosts different packages from the .NET Platform whose original home/branch is not building any longer. The main purpose of it is to be able to have a servicing vehicle for them which uses the latest toolset.

## Project FAQ

- How do I know if a particular package belongs on this repo?
  - As explained above, this repo is meant to be the home for packages that are no longer building in any supported repository/branch. Therefore, if a package/library is still building in one supported branch, then this repository is not the right place for it. The idea of this repo is to have a servicing vehicle for those packages, and if one package is still building in a supported branch, then by definition that is the servicing vehicle that should be used for servicing fixes to it.
- Ok, I've determined that this package does belong on the repo, what is the process to add it?
  - *ToDo*

## How to produce stable package versions

Package versions produced by official builds for this repo will automatically contain a prerelease suffix. This is in order to be able to iterate through changes until we are ready to have a final build when we are ready for a new servicing release. When that time comes, all that is needed in order to produce packages that don't have the prerelease suffix is to manually queue a build in the official pipeline, and set the variable `DotNetFinalVersionKind` to `release`. This will automatically cause Arcade to set the right version for the package, as well as use a dedicated NuGet feed to push the final build assets (in order to avoid potential version clashes).

# How to migrate a library

TODO

## How to service a library

The default build will automatically build all of the libraries that have been added to the repo. That said, given this repository is used to service packages, and you won't always want to service all of the packages at the same time, packages for libraries are not generated by default. To enable a library to produce a package and be serviced:

1. Set the `<IsPackable>` property to `true` in the library's project file.
2. Set the value of the `<VersionPrefix>` property to the value of the other property with the same name but conditioned to `'$(IsPackable)' == 'true'`.
3. Bump the minor version number of the `VersionPrefix` property conditioned with `'$(IsPackable)' == 'true'">` property to the next value.
4. Set the value of the `AssemblyVersion` property, conditioned to `$([MSBuild]::GetTargetFrameworkIdentifier('$(TargetFramework)')) == '.NETFramework'`, to the value of the other property with the same name but conditioned to `'$(IsPackable)' == 'true' and $([MSBuild]::GetTargetFrameworkIdentifier('$(TargetFramework)')) == '.NETFramework'`.
5. Bump the minor version number of the `AssemblyVersion` property conditioned with `$([MSBuild]::GetTargetFrameworkIdentifier('$(TargetFramework)')) == '.NETFramework'` to the next value.
6. Set the `PackageValidationBaselineVersion` property value to the same of the unconditioned `VersionPrefix`.
7. Important: Do not modify the value of the _unconditioned_ `AssemblyVersion`.

### Example

Assuming these are the initial property values of your assembly:

```xml
<VersionPrefix>1.1.1</VersionPrefix>
<VersionPrefix Condition="'$(IsPackable)' == 'true'">1.2.0</VersionPrefix>
<AssemblyVersion>2.2.2.2</AssemblyVersion><!-- NO-INCREMENT: This version is frozen for .NET Standard and .NETCoreApp because the assembly ships inbox. -->
<AssemblyVersion Condition="$([MSBuild]::GetTargetFrameworkIdentifier('$(TargetFramework)')) == '.NETFramework'">2.2.2.2</AssemblyVersion>
<AssemblyVersion Condition="'$(IsPackable)' == 'true' and $([MSBuild]::GetTargetFrameworkIdentifier('$(TargetFramework)')) == '.NETFramework'">2.2.3.0</AssemblyVersion>
<PackageValidationBaselineVersion>1.1.1</PackageValidationBaselineVersion>
```

You need to change them to this:

```xml
<VersionPrefix>1.2.0</VersionPrefix>
<VersionPrefix Condition="'$(IsPackable)' == 'true'">1.2.1</VersionPrefix>
<AssemblyVersion>2.2.2.2</AssemblyVersion><!-- NO-INCREMENT: This version is frozen for .NET Standard and .NETCoreApp because the assembly ships inbox. -->
<AssemblyVersion Condition="$([MSBuild]::GetTargetFrameworkIdentifier('$(TargetFramework)')) == '.NETFramework'">2.2.3.0</AssemblyVersion>
<AssemblyVersion Condition="'$(IsPackable)' == 'true' and $([MSBuild]::GetTargetFrameworkIdentifier('$(TargetFramework)')) == '.NETFramework'">2.2.3.1</AssemblyVersion>
<PackageValidationBaselineVersion>1.2.0</PackageValidationBaselineVersion>
```

## Contribution bar

- [We only consider fixes that unblock critical issues](https://github.com/dotnet/runtime/blob/main/src/libraries/README.md#primary-bar)
- [We don't accept refactoring changes due to new language features](https://github.com/dotnet/runtime/blob/main/src/libraries/README.md#secondary-bars)

This project has adopted the [Microsoft Open Source Code of Conduct](https://opensource.microsoft.com/codeofconduct/). For more information see the [Code of Conduct FAQ](https://opensource.microsoft.com/codeofconduct/faq/) or contact [opencode@microsoft.com](mailto:opencode@microsoft.com) with any additional questions or comments.

## Deployment

All the assemblies in this repository are shipped as NuGet packages.
